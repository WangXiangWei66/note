<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<link rel="stylesheet" type="text/css" href="default.css" />
		<style>
			body, table{font-family: 微软雅黑; font-size: 10pt}
			
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body>
		<div>
			<div><br />
			</div>
			<pre>
<code id="ID_175E4909D5F" class="lang-python hljs"><ol><li><span class="Apple-style-span" style="font-size: x-large;"><span class="hljs-keyword">import</span>  openpyxl    <span class="hljs-comment">#导入模块</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;"><span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> Document</span></li><li><span class="Apple-style-span" style="font-size: x-large;"><span class="hljs-keyword">from</span>  docx.shared <span class="hljs-keyword">import</span>  Pt,RGBColor</span></li><li><span class="Apple-style-span" style="font-size: x-large;"><span class="hljs-keyword">from</span> docx.enum.text <span class="hljs-keyword">import</span>  WD_PARAGRAPH_ALIGNMENT</span></li><li><span class="Apple-style-span" style="font-size: x-large;">wk=openpyxl.load_workbook(<span class="hljs-string">'data/附件2：反洗钱人员考试题库.xlsx'</span>) <span class="hljs-comment"># 加载Excel文件</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">sheet=wk[<span class="hljs-string">'通用题库'</span>]   <span class="hljs-comment">#获得名称为'通用题库'的工作表</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">rows=sheet.rows  <span class="hljs-comment"># 获取所有行</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">lst=[]      <span class="hljs-comment"># 存储所有行</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;"><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> rows: <span class="hljs-comment"># 遍历所有行</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    sub_lst=[]  <span class="hljs-comment">#存储所有列</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row:  <span class="hljs-comment">#遍历每一行</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">        sub_lst.append(cell.value) <span class="hljs-comment"># 将每一列的值添到 sub_lst</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    lst.append(sub_lst) <span class="hljs-comment">#将一整行添加到总lst</span></span></li><li><span class="hljs-comment" style="font-size: x-large;">#------------------转Word文档----------------------------------</span></li><li><span class="Apple-style-span" style="font-size: x-large;">doc=Document()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">title=doc.add_heading(<span class="hljs-string">'反洗钱人员考试题库'</span>,level=<span class="hljs-number">1</span>)</span></li><li><span class="Apple-style-span" style="font-size: x-large;">title.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER</span></li><li><span class="Apple-style-span" style="font-size: x-large;">para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;"><span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> range(<span class="hljs-number">2</span>,len(lst)):</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    para=doc.add_paragraph() <span class="hljs-comment"># 添加一个段落  (题干)</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    para.add_run(str(lst[index][<span class="hljs-number">0</span>])+<span class="hljs-string">'.\t'</span>).blod=<span class="hljs-keyword">True</span> <span class="hljs-comment"># 添加序号</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    para.add_run(lst[index][<span class="hljs-number">3</span>]).blod=<span class="hljs-keyword">True</span>  <span class="hljs-comment">#添中题干</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    <span class="hljs-comment">#添加段落 （答案）A,B,C,D</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerA_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerA_para.add_run(<span class="hljs-string">'A、\t'</span>+str(lst[index][<span class="hljs-number">6</span>]) )  <span class="hljs-comment"># 答案A</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerB_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerB_para.add_run(<span class="hljs-string">'B、\t'</span> + str(lst[index][<span class="hljs-number">7</span>]))  <span class="hljs-comment"># 答案B</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerC_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerC_para.add_run(<span class="hljs-string">'C、\t'</span> + str(lst[index][<span class="hljs-number">8</span>]))  <span class="hljs-comment"># 答案C</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerD_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    answerD_para.add_run(<span class="hljs-string">'D、\t'</span> + str(lst[index][<span class="hljs-number">9</span>]))  <span class="hljs-comment"># 答案D</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    <span class="hljs-keyword">if</span> lst[index][<span class="hljs-number">10</span>]!=<span class="hljs-keyword">None</span>:</span></li><li><span class="Apple-style-span" style="font-size: x-large;">        answerE_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">        answerE_para.add_run(<span class="hljs-string">'E、\t'</span> + str(lst[index][<span class="hljs-number">10</span>]))  <span class="hljs-comment"># 答案E</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    <span class="hljs-keyword">if</span> lst[index][<span class="hljs-number">11</span>]!=<span class="hljs-keyword">None</span>:</span></li><li><span class="Apple-style-span" style="font-size: x-large;">        answerF_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">        answerF_para.add_run(<span class="hljs-string">'F、\t'</span> + str(lst[index][<span class="hljs-number">11</span>]))  <span class="hljs-comment"># 答案F</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    <span class="hljs-keyword">if</span> lst[index][<span class="hljs-number">12</span>]!=<span class="hljs-keyword">None</span>:</span></li><li><span class="Apple-style-span" style="font-size: x-large;">        answerG_para = doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">        answerG_para.add_run(<span class="hljs-string">'G、\t'</span> + str(lst[index][<span class="hljs-number">11</span>]))  <span class="hljs-comment"># 答案G</span></span></li><li><span class="Apple-style-span" style="font-size: x-large;">    right_aswer_para=doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    right_aswer_para.add_run(<span class="hljs-string">'正确答案为:\t'</span>+str(lst[index][<span class="hljs-number">5</span>])).font.color.rgb=RGBColor(<span class="hljs-number">255</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)</span></li><li><span class="Apple-style-span" style="font-size: x-large;">    doc.add_paragraph()</span></li><li><span class="Apple-style-span" style="font-size: x-large;">doc.save(<span class="hljs-string">'data/题库.docx'</span>)</span></li><li></li></ol></code></pre>
			<div><br />
			</div>
		</div>
	</body>
</html>